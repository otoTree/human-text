metadata:
  directive_count: 0
  source_file: sop_test_cases/level_2_medium_natural.txt
  compiled_at: '2025-07-14T16:39:32.258828'
variables:
- name: complaint_severity
  value: ''
  type: string
  scope: global
- name: customer_type
  value: ''
  type: string
  scope: global
- name: satisfaction_score
  value: '0'
  type: string
  scope: global
tasks:
- id: receive_complaint
  title: Receive and evaluate complaint
  body:
  - type: tool_call
    line_number: 7
    tool_call:
      name: crm_system_create
      description: Create complaint ticket
  - type: text
    content: Create new complaint ticket in CRM system
    line_number: 6
  - type: text
    content: 'Record customer info, contact details and complaint content     Set
      initial severity level: {{complaint_severity}}     Analyze complaint severity     Query
      customer type: {{customer_type}}'
    line_number: 8
  - type: conditional
    line_number: 12
    conditional:
      branches:
      - condition: complaint_severity == "high" OR customer_type == "VIP"
        actions:
        - type: jump
          jump:
            target: escalate_complaint
      - actions:
        - type: jump
          jump:
            target: regular_processing
      line_number: 12
- id: regular_processing
  title: Regular processing
  body:
  - type: text
    content: Assign ticket to regular support team     Contact customer for 
      details     Conduct internal investigation     Develop solution and 
      implement
    line_number: 18
  - type: next_action
    line_number: 22
    next_action:
      target: customer_confirmation
  next:
  - customer_confirmation
- id: escalate_complaint
  title: Escalate complaint
  body:
  - type: tool_call
    line_number: 26
    tool_call:
      name: notification_service_alert
      description: Notify relevant departments
  - type: text
    content: Assign ticket to senior support team
    line_number: 25
  - type: text
    content: Create emergency action plan     Maintain real-time communication 
      with customer     Implement solution
    line_number: 27
  - type: next_action
    line_number: 30
    next_action:
      target: customer_confirmation
  next:
  - customer_confirmation
- id: customer_confirmation
  title: Customer communication and confirmation
  body:
  - type: tool_call
    line_number: 35
    tool_call:
      name: satisfaction_survey
      description: Collect feedback
  - type: text
    content: 'Contact customer to explain solution     Collect satisfaction score:
      {{satisfaction_score}}'
    line_number: 33
  - type: conditional
    line_number: 36
    conditional:
      branches:
      - condition: satisfaction_score >= 4
        actions:
        - type: jump
          jump:
            target: close_case
      - actions:
        - type: jump
          jump:
            target: reprocess_complaint
      line_number: 36
- id: reprocess_complaint
  title: Re-process complaint
  body:
  - type: text
    content: Reactivate ticket status     Assign to higher-level technician     
      Re-evaluate problem     Develop additional compensation if needed     
      Implement new solution
    line_number: 42
  - type: next_action
    line_number: 47
    next_action:
      target: customer_confirmation
  next:
  - customer_confirmation
- id: close_case
  title: Close and archive case
  body:
  - type: tool_call
    line_number: 51
    tool_call:
      name: crm_system_update
      description: Update ticket status
  - type: text
    content: Update ticket status to "Resolved" in CRM
    line_number: 50
  - type: text
    content: Write detailed closure report     Archive all records and 
      communications
    line_number: 52
  - type: next_action
    line_number: 54
    next_action:
      target: END
  next:
  - END
- id: END
  title: Process complete
  body:
  - type: text
    content: Complaint handling process completed
    line_number: 57
entry_point: receive_complaint
compiled_at: 2025-07-14 16:39:32.258851
source_files:
- sop_test_cases/level_2_medium_natural.txt
